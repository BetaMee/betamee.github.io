{"componentChunkName":"component---src-templates-blog-template-tsx","path":"/content/React-React 状态管理使用指南/","webpackCompilationHash":"939c21a038fa74314c13","result":{"data":{"site":{"siteMetadata":{"author":"橡树上","title":"十二棵橡树"}},"markdownRemark":{"id":"d894d7d6-1061-5c4b-9f89-24d221529b3f","html":"<h2 id=\"目录\"><a href=\"#%E7%9B%AE%E5%BD%95\" aria-label=\"目录 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目录</h2>\n<!-- toc -->\n<ul>\n<li><a href=\"#1-%E5%BC%95%E8%A8%80\">1. 引言</a></li>\n<li><a href=\"#2-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8B-redux-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\">2. 状态管理之 Redux 解决方案</a></li>\n<li><a href=\"#3-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8B-mobX-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\">3. 状态管理之 MobX 解决方案</a></li>\n<li><a href=\"#4-%E8%BF%99%E4%B8%AA-example-%E9%95%BF%E5%95%A5%E6%A0%B7\">4. 这个 example 长啥样</a></li>\n<li><a href=\"#5-Classic-React-App-with-Redux\">5. Classic React App with Redux</a></li>\n<li><a href=\"#6-Classic-React-App-with-Mobx\">6. Classic React App with Mobx</a></li>\n<li><a href=\"#7-React-Hooks-App-with-Redux\">7. React Hooks App with Redux</a></li>\n<li><a href=\"#8-React-Hooks-App-with-Mobx\">8. React Hooks App with Mobx</a></li>\n<li><a href=\"#9-%E6%80%BB%E7%BB%93\">9. 总结</a></li>\n<li>\n<p><a href=\"#%E5%8F%82%E8%80%83\">参考</a></p>\n<!-- tocstop -->\n</li>\n</ul>\n<h2 id=\"1-引言\"><a href=\"#1-%E5%BC%95%E8%A8%80\" aria-label=\"1 引言 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 引言</h2>\n<p>在日趋复杂的 Web 应用中，状态管理一直是一个很重要的话题。React 技术栈中也衍生出了不少解决方案，如 Redux、Mobx，并且随着 React Hooks 的发布，带来全新的代码编写模式，在状态管理库的使用上也出现了很多新变化。</p>\n<p>为了指明 React 状态管理，我写了几个 examples，并比较一下其中的使用差异。</p>\n<p>开发同一个 Todo App，但使用方式分为以下四种：</p>\n<ul>\n<li>使用类模式的 React + Redux</li>\n<li>使用类模式的 React + Mobx</li>\n<li>使用 Hooks 模式的 React + Redux</li>\n<li>使用 Hooks 模式的 React + Mobx</li>\n</ul>\n<p>全部代码发布在 Github 的这个仓库 <a href=\"https://github.com/BetaMee/react-usage-examples\">GitHub - BetaMee/react-usage-examples: React Usage Examples</a> 上，可供参考。</p>\n<h2 id=\"2-状态管理之-redux-解决方案\"><a href=\"#2-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8B-redux-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\" aria-label=\"2 状态管理之 redux 解决方案 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 状态管理之 Redux 解决方案</h2>\n<p>Redux 是很火的一个技术解决方案，甫一推出就备受关注。Redux 由 <a href=\"http://facebook.github.io/flux/\">Flux</a> 演变而来，但受 Elm 的启发，避开了 Flux 的复杂性。它提供了一套简单但有效的 API，提供可预测化的状态管理。但在学习难度上非常陡峭，因为它带来新的概念和约定，只有理解通了，才可以更好的应用它。</p>\n<p>要理解 Redux，可以分为以下几个点：</p>\n<blockquote>\n<ol>\n<li>所有的 state 都以一个对象树的形式存储在一个单一的 store 中</li>\n<li>UI 是这个 state 树某一时刻状态的映射</li>\n<li>改变 state 树的唯一方式是触发一个 action，一个描述发生什么的对象</li>\n<li>至于对 state 树的具体改变操作，是由叫 reducers 的纯函数来实现</li>\n<li>更新后的 state 树又映射为新的 UI</li>\n</ol>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1000px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.51470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB93GpHRFWBQf/xAAbEAEAAgIDAAAAAAAAAAAAAAABERIAAhAhMf/aAAgBAQABBQKe5qZUtuCHmRx//8QAFhEAAwAAAAAAAAAAAAAAAAAAASAx/9oACAEDAQE/ARU//8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQIBAT8BY//EABwQAAEDBQAAAAAAAAAAAAAAABAAASIREiExQf/aAAgBAQAGPwKik4u6paOR/8QAHhABAAICAQUAAAAAAAAAAAAAAQARECExQVFhcYH/2gAIAQEAAT8hTzlw2xfMNlzpntKbSAADjG3d8x//2gAMAwEAAgADAAAAEG/IPP/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QAjY3/8QAGBEAAgMAAAAAAAAAAAAAAAAAARARITH/2gAIAQIBAT8QKBS1f//EABsQAQEBAQEAAwAAAAAAAAAAAAERACFREDFB/9oACAEBAAE/EDQ57L01QZf19ZABolE1OXmYzHp5NIiACefFCIPmBCG//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Redux Flow\"\n        title=\"Redux Flow\"\n        src=\"/static/32d1d59087ce53b4542d2189b76a3876/971c4/redux-flow.jpg\"\n        srcset=\"/static/32d1d59087ce53b4542d2189b76a3876/9fb78/redux-flow.jpg 250w,\n/static/32d1d59087ce53b4542d2189b76a3876/48a11/redux-flow.jpg 500w,\n/static/32d1d59087ce53b4542d2189b76a3876/971c4/redux-flow.jpg 1000w,\n/static/32d1d59087ce53b4542d2189b76a3876/a15de/redux-flow.jpg 1088w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<center>图 2.1 Redux Flow</center>\n<p>由上可以总结为<strong>Redux 三大原则：</strong></p>\n<blockquote>\n<ul>\n<li>单一数据源</li>\n<li>state 是只读的</li>\n<li>使用纯函数来执行修改</li>\n</ul>\n</blockquote>\n<p>理通上述概念基本上可以入门 Redux 了。但只有上述概念无法解决 Web 应用更复杂的场景，如异步加载数据更新界面。</p>\n<p>这就需要涉及到 Redux 中的<strong>中间件</strong>概念。</p>\n<p>使用中间件，我们可以在 state 变化的时候对数据进行<em>监控、截获、更改</em>，还可以拓展异步操作。这就给了我们很大的自由，充分发挥 Redux 的潜力。</p>\n<p>Redux 的中间件实质上是一个函数，是对<code>store.dispatch</code>方法进行了改造，在发出 Action 和执行 Reducer 这两步之间，添加了特定功能。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1000px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.51470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB93Gsx1RVgUH/xAAbEAEAAgIDAAAAAAAAAAAAAAABERIAAhAhMf/aAAgBAQABBQKe5qZUtuCHmRx//8QAFhEAAwAAAAAAAAAAAAAAAAAAASAx/9oACAEDAQE/ARU//8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQIBAT8BY//EABsQAAEEAwAAAAAAAAAAAAAAABAAESEiARIx/9oACAEBAAY/AmVsjZpVuGR//8QAHRABAAICAgMAAAAAAAAAAAAAAQARECExUWGBsf/aAAgBAQABPyFPOXC2i+YbLn1iU2kAAHGNu3rH/9oADAMBAAIAAwAAABBfyDz/xAAXEQEAAwAAAAAAAAAAAAAAAAABABAR/9oACAEDAQE/EAI2N//EABgRAAIDAAAAAAAAAAAAAAAAAAEQESEx/9oACAECAQE/ECgUtX//xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMVFB/9oACAEBAAE/EDQ49l5NEMv11kAGiUTPYWZkC8nk0iIAJ5nUIg+YEIb/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"redux-flow-middleware\"\n        title=\"redux-flow-middleware\"\n        src=\"/static/0caa678bb06618e7568a58a23317d788/971c4/redux-flow-middleware.jpg\"\n        srcset=\"/static/0caa678bb06618e7568a58a23317d788/9fb78/redux-flow-middleware.jpg 250w,\n/static/0caa678bb06618e7568a58a23317d788/48a11/redux-flow-middleware.jpg 500w,\n/static/0caa678bb06618e7568a58a23317d788/971c4/redux-flow-middleware.jpg 1000w,\n/static/0caa678bb06618e7568a58a23317d788/a15de/redux-flow-middleware.jpg 1088w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<center>图 2.2 Redux Flow Middleware</center>\n<p>Redux 社区已经发展了很多成熟的中间件，如 redux-thunk、redux-soga，只需要按需使用即可。</p>\n<p>具体可参考：<a href=\"https://redux.js.org/introduction/ecosystem#middleware\">redux#ecosystem#middleware</a> 和 中文版本的 <a href=\"http://cn.redux.js.org/docs/introduction/Ecosystem.html\">cnredux#ecosystem</a></p>\n<h2 id=\"3-状态管理之-mobx-解决方案\"><a href=\"#3-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8B-mobx-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\" aria-label=\"3 状态管理之 mobx 解决方案 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 状态管理之 MobX 解决方案</h2>\n<p>与 Redux 相似的，前端出现的另一个状态管理方案是 MobX。</p>\n<p>MobX 的官网是这样介绍的：</p>\n<blockquote>\n<p>MobX 是一个经过战火洗礼的库，它通过透明的函数响应式编程 (transparently applying functional reactive programming - TFRP) 使得状态管理变得简单和可扩展。MobX背后的哲学很简单:\n<em>任何源自应用状态的东西都应该自动地获得。</em>\n其中包括UI、数据序列化、服务器通讯，等等。</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1000px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.32835820895522%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABf0lEQVQoz1WQz4vTQBTH86968u7fIKLgwYM3TwsilGU96EUXxfUg7HZRcME22xYhP5ofTTNpk6ZJJmk+vkmpsA+Gee/7vvOZN2PR5Xy+9nn82uHJGxf7b8KhSnk2uubRq0tenN/QNxV2eMvl7IKrxUe+zN4TZD6HTUBzN6L5dUYX/saEBS1je8vzdwtenjs4UQl9y9nXCU9HY95+mw5GR825ca/46f9g7H4nqzKod+jZJ/T0A916cQT2nKITUCrTbOFQS33qyN7KJRx4EMbT64eaeK2yLNnmOcswRinFvtyRbzcEQYDjOsSrWLSCNE1IkogwXJJla0rRlGirKCARzybLMCwrTVOiKOLPZMJsPme9TonjleSLQXM9T2BK4C6T6RT7/h7fX6IE4Hn+UbNtyb1hIKtpGnKZ0IDNXtf1sEytBFRVFVpriqIYLl7JKsRnNOM3ECVe0zcsy7y8bbuh0G1L3x//br/fD7BTbQDlbifPL/9rpl9VNVrOtvr4n/8AvcULBRTpm10AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mobx-flow\"\n        title=\"mobx-flow\"\n        src=\"/static/7c7e6d63765099c40c9aabfebc23e712/e11df/mobx-flow.png\"\n        srcset=\"/static/7c7e6d63765099c40c9aabfebc23e712/5039d/mobx-flow.png 250w,\n/static/7c7e6d63765099c40c9aabfebc23e712/d19c0/mobx-flow.png 500w,\n/static/7c7e6d63765099c40c9aabfebc23e712/e11df/mobx-flow.png 1000w,\n/static/7c7e6d63765099c40c9aabfebc23e712/a0105/mobx-flow.png 1407w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<center>图 3-1 MobX Flow</center>\n<p>其实相比 Redux 的强规则约定，MobX 明显更简单灵活，MobX 的核心原理是<strong>通过 action  触发 state 的变化，进而触发 state 的衍生对象（Computed value &#x26; Reactions）</strong>。开发者只需要定义需要 Observe 的数据和由此衍生的数据（Computed value）或者操作 (Reactions），剩下的更新自然就交给 MobX 去做就可以了。</p>\n<p>MobX 和 Redux 比较大概体现出这些差异：</p>\n<blockquote>\n<ol>\n<li>Redux 是函数式而 MobX 是面向对象</li>\n<li>Redux 的 state 每次返回新的数据，理想状态是 immutable 的，MobX 则至始至终保持一份引用</li>\n<li>Redux 可支持数据回朔，MobX 由于只有一份引用，无法支持回朔</li>\n<li>Redux 约定单一数据源，MobX 可以将 state 树拆分进多个 store 中</li>\n<li>Redux 需要中间件处理异步，MobX 可以直接使用 async/await 来处理</li>\n</ol>\n</blockquote>\n<p>总之，两者相比，MobX 确实比 Redux 上手更容易些，并且不需要写很多样板代码，但 Redux 的这种“复杂”不一定是无用的，强约定的规则可以为大型项目，复杂数据状态管理提供可靠的支持，而 MobX 在某些场景下确实可以比 Redux 项目提供更高效的选择。</p>\n<p>但也不能简单地就将 Redux 复杂化，MobX 简单化，还是要看适合的场景。我们应该更关注它们解决什么问题，它们解决问题的关注点，或者说实现方式是什么，它们的优缺点还有什么，哪一个更适合当前项目，以及项目未来发展。</p>\n<h2 id=\"4-这个-example-长啥样\"><a href=\"#4-%E8%BF%99%E4%B8%AA-example-%E9%95%BF%E5%95%A5%E6%A0%B7\" aria-label=\"4 这个 example 长啥样 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 这个 example 长啥样</h2>\n<p>我们做的这个 Todo 只涉及到简单的增删功能：</p>\n<p><img src=\"./attachments/todoapp.gif\" alt=\"todoapp\"></p>\n<h2 id=\"5-classic-react-app-with-redux\"><a href=\"#5-classic-react-app-with-redux\" aria-label=\"5 classic react app with redux permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Classic React App with Redux</h2>\n<p>接下来我将具体介绍四个 example 的用法，并从中学习<strong>项目的组织模式、代码的编写模式</strong>，看一看 React 的状态管理库的应用发展。</p>\n<p>第一个是 Classic React App with Redux，是使用“传统”的类模式 + Redux 进行开发的。这个模式在 Redux 刚推出时就有了。</p>\n<p>我们通过 create-react-app 脚手架来搭建我们的启动应用，这将会节省我们很多时间：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx create-react-app classicreactwithredux --typescript</code></pre></div>\n<p>这里使用的是 Typescript 模版，整个应用都将以 TS 来开发，所以这也是个学习 TS 的一个练手机会。</p>\n<p>以下是整个应用的代码文件：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">├── README.md\n├── package.json\n├── public\n│   ├── favicon.ico\n│   ├── index.html\n│   └── manifest.json\n├── src // 源码文件，所有的代码在这里\n│   ├── App.css\n│   ├── App.test.tsx\n│   ├── App.tsx // App 入口\n│   ├── components // UI 组件\n│   │   ├── TodoAdd.tsx\n│   │   ├── TodoCounter.tsx\n│   │   ├── TodoView.tsx\n│   │   ├── TodoViewList.tsx\n│   │   ├── assets\n│   │   │   ├── delete.svg\n│   │   │   ├── select.svg\n│   │   │   └── select2.svg\n│   │   └── styles\n│   │       ├── TodoAdd.css\n│   │       ├── TodoCounter.css\n│   │       ├── TodoView.css\n│   │       └── TodoViewList.css\n│   ├── containers // 容器组件\n│   │   ├── TodoAddContainer.ts\n│   │   ├── TodoCounterContainer.ts\n│   │   └── TodoViewListContainer.ts\n│   ├── index.css\n│   ├── index.tsx // 整个应用的入口文件\n│   ├── interfaces // 定义的 ts 接口文件\n│   │   ├── component.ts\n│   │   └── index.ts\n│   ├── react-app-env.d.ts\n│   ├── serviceWorker.ts\n│   └── store // 这里放置 store 文件\n│       ├── store.ts\n│       └── todo // 按角色划分 state 树，一个文件夹一个角色\n│           ├── actions.ts\n│           ├── index.ts\n│           ├── reducers.ts\n│           └── types.ts\n├── tsconfig.json\n└── yarn.lock</code></pre></div>\n<p><code>index.tsx</code> 作为入口文件，承担着全局初始化工作的任务，可以将初始化 store 、render app 等任务放在这里。</p>\n<p>我们通过 <code>react-redux</code> 提供的 <code>Provider</code> 包裹 <code>App</code> 组件，将 store 数据注入全局应用，下面的组件可以通过一定方式获取 redux 的数据。后续我会介绍如何在 container 组件中使用。</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./index.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">'./App'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> serviceWorker <span class=\"token keyword\">from</span> <span class=\"token string\">'./serviceWorker'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> configureStore <span class=\"token keyword\">from</span> <span class=\"token string\">'./store/store'</span>\n<span class=\"token comment\">// 初始化 redux store</span>\n<span class=\"token keyword\">const</span> AppStore <span class=\"token operator\">=</span> <span class=\"token function\">configureStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>AppStore<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserviceWorker<span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>在 <code>configureStore</code> 函数中，执行的是组合 root state、加载中间件任务，所有对 redux 的配置基本上都在这里：</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  createStore<span class=\"token punctuation\">,</span>\n  combineReducers\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> todoReducer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./todo/'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 根 rootReducer</span>\n<span class=\"token keyword\">const</span> rootReducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  todoReducer<span class=\"token punctuation\">:</span> todoReducer\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 导出store 类型</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> AppState <span class=\"token operator\">=</span> ReturnType<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> rootReducer<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">configureStore</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 组合中间件，这个例子没有用到</span>\n  <span class=\"token comment\">// const middlewares = [thunkMiddleware];</span>\n  <span class=\"token comment\">// const middleWareEnhancer = applyMiddleware(...middlewares);</span>\n  <span class=\"token comment\">// 创建 store</span>\n  <span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>rootReducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> store<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> configureStore\n\n<span class=\"token keyword\">export</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./todo'</span></code></pre></div>\n<p>这里我们对 Redux 的 state 按<strong>角色</strong>划分，如这里的状态数据 todo，我们在 todo 的文件夹下配置 <code>action</code>、<code>reducers</code> 项，然后统一导出：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">│       └── todo // 按角色划分 state 树，一个文件夹一个角色\n│           ├── actions.ts\n│           ├── index.ts\n│           ├── reducers.ts\n│           └── types.ts</code></pre></div>\n<p>这个的好处就是依赖清晰，后续扩展很方便，比如再增加一个新的状态数据，只需要新增文件夹，把这个“<strong>角色</strong>”的逻辑写清楚就可以了。</p>\n<p>当然，Redux 不只是可以按照角色划分，也可以按照<strong>功能</strong>划分，如所有的 <code>actions</code> 统一放到 action 文件夹下， <code>reducers</code> 放到 renduers 文件夹下:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 示例：按功能拆分文件夹\n│       └── actions\n│           ├── index.ts\n│       └── renduers\n│           ├── index.ts\n│       └── types\n│           ├── index.ts</code></pre></div>\n<p>接下来，我们看一下 todo 文件下，是如何编写 Reducer 和 Action 逻辑的：</p>\n<p><strong>reducers.ts:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  TodoReducerType<span class=\"token punctuation\">,</span>\n  TodoActionType\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">ADD_TODO</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">REMOVE_TODO</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">SELECT_TODO</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n\n<span class=\"token comment\">// 初始化状态</span>\n<span class=\"token keyword\">const</span> initalState<span class=\"token punctuation\">:</span> TodoReducerType <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> todoReducer <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> initalState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> TodoActionType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">TodoReducerType</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ADD_TODO</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        id<span class=\"token punctuation\">:</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        name<span class=\"token punctuation\">:</span> action<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        finished<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">REMOVE_TODO</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">!==</span> action<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">SELECT_TODO</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> action<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>todo<span class=\"token punctuation\">,</span>\n            finished<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span>todo<span class=\"token punctuation\">.</span>finished\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> todo\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>actions.ts:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">ADD_TODO</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">REMOVE_TODO</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">SELECT_TODO</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  TodoActionType\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> addTodo <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">TodoActionType</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">ADD_TODO</span><span class=\"token punctuation\">,</span>\n  name<span class=\"token punctuation\">:</span> name\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> removeTodo <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">TodoActionType</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">REMOVE_TODO</span><span class=\"token punctuation\">,</span>\n  id<span class=\"token punctuation\">:</span> id\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> selectTodo <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">TodoActionType</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">SELECT_TODO</span><span class=\"token punctuation\">,</span>\n  id<span class=\"token punctuation\">:</span> id\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>这两个文件决定了每个角色 state 以下两个关键点，这是使用 Redux 的精髓：</p>\n<blockquote>\n<ol>\n<li>action 纯函数：描述如何改变状态（是什么）</li>\n<li>reducer 纯函数：描述具体改变状态的逻辑（怎么做）</li>\n</ol>\n</blockquote>\n<p>其中 <code>actions.ts</code> 中的函数是我们需要导入到 UI 组件中去的，才能发挥作用。</p>\n<p>那么我们是如何将 <code>actions</code>（操作） 和 <code>state</code>（状态）具体导入到组件中去呢？</p>\n<p>这就是 container 文件夹下的 container 组件需要回答的问题:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">│   ├── containers // 容器组件\n│   │   ├── TodoAddContainer.ts\n│   │   ├── TodoCounterContainer.ts\n│   │   └── TodoViewListContainer.ts</code></pre></div>\n<p>其实不要被 Redux 中所谓的<strong>容器组件</strong>、<strong>UI 组件</strong>概念迷惑，这其实就是一个连接 Redux 和 React 组件的中间步骤而已。</p>\n<p>这里以 <code>TodoViewListContainer.ts</code> 为例：</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> connect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  Dispatch\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n\n<span class=\"token keyword\">import</span> TodoViewList <span class=\"token keyword\">from</span> <span class=\"token string\">'../components/TodoViewList'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  AppState<span class=\"token punctuation\">,</span>\n  TodoActionType<span class=\"token punctuation\">,</span>\n\n  removeTodo<span class=\"token punctuation\">,</span>\n  selectTodo\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store/store'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapStateToProps</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> AppState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  todos<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>todoReducer\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapDispatchToProps</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">dispatch<span class=\"token punctuation\">:</span> Dispatch<span class=\"token operator\">&lt;</span>TodoActionType<span class=\"token operator\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">removeTodoById</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">removeTodo</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">selectTodoById</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">selectTodo</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>mapStateToProps<span class=\"token punctuation\">,</span> mapDispatchToProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>TodoViewList<span class=\"token punctuation\">)</span></code></pre></div>\n<p>其中，<code>TodoViewList</code> 是具体的 React 组件，<code>mapStateToProps</code>、<code>mapDispatchToProps</code> 如其名字所示，是将 action 和 state 作为 React 的 <code>props</code> 往下导入。</p>\n<p>然后在 <code>TodoViewList</code> 组件中，我们这样使用：</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token keyword\">import</span> TodoView <span class=\"token keyword\">from</span> <span class=\"token string\">'./TodoView'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles/TodoViewList.css'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  IViewListProp\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../interfaces'</span>\n\n<span class=\"token keyword\">const</span> TodoViewList<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IViewListProp</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> = ({\n  todos,\n  selectTodoById,\n  removeTodoById\n}) => (\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewlist<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoView</span></span>\n        <span class=\"token attr-name\">todo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">selectTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>selectTodoById<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">removeTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>removeTodoById<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n)\n\nexport default TodoViewList</span></code></pre></div>\n<p>这就是 React 和 Redux 的结合使用，到这一步基本完成所有的工作了，后续只要 state 有变化，组件就会发生更新，而<strong>要使 state 发生变化，唯一的途径是传入的 action 函数</strong>。这样，整个应用依赖清晰，数据流变化清晰可调控，对于排查问题非常方便。</p>\n<h2 id=\"6-classic-react-app-with-mobx\"><a href=\"#6-classic-react-app-with-mobx\" aria-label=\"6 classic react app with mobx permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Classic React App with Mobx</h2>\n<p>接下来我们看看使用类模式 + MobX 架构的 Todo 应用。</p>\n<p>先整体看一下这里的文件结构：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">├── README.md\n├── package.json\n├── public\n│   ├── favicon.ico\n│   ├── index.html\n│   └── manifest.json\n├── src // 源码\n│   ├── App.css\n│   ├── App.test.tsx\n│   ├── App.tsx\n│   ├── components // UI 组件\n│   │   ├── TodoAdd.tsx\n│   │   ├── TodoCounter.tsx\n│   │   ├── TodoView.tsx\n│   │   ├── TodoViewList.tsx\n│   │   ├── assets\n│   │   │   ├── delete.svg\n│   │   │   ├── select.svg\n│   │   │   └── select2.svg\n│   │   └── styles\n│   │       ├── TodoAdd.css\n│   │       ├── TodoCounter.css\n│   │       ├── TodoView.css\n│   │       └── TodoViewList.css\n│   ├── index.css\n│   ├── index.tsx // 入口\n│   ├── interfaces // 定义的 ts 接口\n│   │   ├── base.ts\n│   │   └── index.ts\n│   ├── react-app-env.d.ts\n│   ├── serviceWorker.ts\n│   └── store // 存放 mobx store\n│       ├── TodoListStore.ts\n│       └── index.ts\n├── tsconfig.json\n└── yarn.lock</code></pre></div>\n<p>和 Redux 的最大区别在于，Redux 是面向函数式的思维，而 MobX 是<strong>面向对象</strong>的思维。我们来看一下在 MobX 中是如何定义 store 的：</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  observable<span class=\"token punctuation\">,</span>\n  computed<span class=\"token punctuation\">,</span>\n  action\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  ITodo\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../interfaces'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span> <span class=\"token punctuation\">{</span>\n  id <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  @observable name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  @observable finished <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoListStore</span> <span class=\"token punctuation\">{</span>\n  @observable todos<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>ITodo<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  @computed <span class=\"token keyword\">get</span> <span class=\"token function\">finishedTodoCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>finished<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length\n  <span class=\"token punctuation\">}</span>\n  @computed <span class=\"token keyword\">get</span> <span class=\"token function\">totalCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length\n  <span class=\"token punctuation\">}</span>\n  @action\n  <span class=\"token keyword\">public</span> <span class=\"token function-variable function\">finishTodoById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        todo<span class=\"token punctuation\">.</span>finished <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>todo<span class=\"token punctuation\">.</span>finished\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  @action\n  <span class=\"token keyword\">public</span> <span class=\"token function-variable function\">addNewTodo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Todo</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  @action\n  <span class=\"token keyword\">public</span> <span class=\"token function-variable function\">removeTodoById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 找到某一项的位置</span>\n    <span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TodoListStore</code></pre></div>\n<p>我们定义一个类，里面封装<strong>状态 + 函数</strong>，给状态打上 <code>@observable</code> 装饰器，给函数打上 <code>@action</code> 装饰器。因为 MobX 在约束上很自由，只要触动 <code>@observable</code> 的数据就会发生更新，但这样的话就会发生滥用<strong>通过状态直接更新</strong>的操作，不容易追踪数据变化流程。比如在组件中随手的一个：<code>this.props.todos.push(...)</code>，这就会触发整个应用数据更新。</p>\n<p>所以 MobX 推荐使用严格模式，我们只能通过被 <code>@action</code> 状态装饰过的函数来变更状态，这个和 Redux 中通过 action 函数来变更状态思路是一致，保证数据变化可追踪调控。</p>\n<p>与 Redux 另一个不同点，是在 MobX 中我们直接可以编写<strong>计算过</strong>的 <code>@computed</code> 数据逻辑，在 Redux 中，我们只能通过获取的 state 手动计算，而在 MobX 中，通过 <code>@computed</code> 装饰的 <code>get</code> 函数可以一直获取最新的计算值。这也是 MobX 的理念：<strong>任何源自应用状态的东西都应该自动地获得</strong>。</p>\n<p>由于 MobX 不像 Redux 约定单一数据源，所以我们要拓展状态也很简单，继续添加新的类，封装好需要 <code>@observable</code> 的状态、 <code>@computed</code> 的状态以及对应于数据更新的 <code>@action</code> 函数。</p>\n<p>在组件接入 MobX 的过程也比 Redux 要简单很多。</p>\n<p>首先是在入口组件中配置：</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./index.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">'./App'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  TodoListStore\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./store'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  Provider\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span>\n\n<span class=\"token comment\">// 状态</span>\n<span class=\"token keyword\">const</span> rootStore <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  todoListStore<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span> \n\n<span class=\"token comment\">// 通过 Provider/inject 来注入，react 16.8 + 可以使用 hooks + context 来注入</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Provider</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">rootStore</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Provider</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLElement\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>然后在需要使用 MobX 状态的组件中使用 <code>mobx-react</code> 包中的 <code>observer</code> 和 <code>inject</code> 高阶函数将数据注入：</p>\n<p><strong>App.tsx:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  observer<span class=\"token punctuation\">,</span>\n  inject\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span>\n\n<span class=\"token keyword\">import</span> TodoAdd <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoAdd'</span>\n<span class=\"token keyword\">import</span> TodoViewList <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoViewList'</span>\n<span class=\"token keyword\">import</span> TodoCounter <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoCounter'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./App.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> IAppProp <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./interfaces'</span>\n\n<span class=\"token comment\">// ! @inject 高阶方法注入会和 Typescript 有冲突，原因在于 TS 会检查外部调用传进来的 props 接口，</span>\n<span class=\"token comment\">// ! 但是 inject 相当于中间注入，避开了检查，这就导致 TS 报错。</span>\n\n<span class=\"token keyword\">const</span> App<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IAppProp</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> = inject('todoListStore')(observer(({ todoListStore }) => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Classic React App ( mobx )</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoAdd</span></span>\n        <span class=\"token attr-name\">addNewTodo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>addNewTodo<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoViewList</span></span>\n        <span class=\"token attr-name\">todos</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">finishTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>finishTodoById<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">removeTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>removeTodoById<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoCounter</span></span>\n        <span class=\"token attr-name\">finishedCount</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>finishedTodoCount<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">totalCount</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoListStore<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>totalCount<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">))\n\nexport default App;</span></code></pre></div>\n<p><strong>TodoViewList.tsx:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span>\n\n<span class=\"token keyword\">import</span> TodoView <span class=\"token keyword\">from</span> <span class=\"token string\">'./TodoView'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles/TodoViewList.css'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  IViewListProp\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../interfaces'</span>\n\n@observer\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoViewList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span><span class=\"token operator\">&lt;</span>IViewListProp<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      removeTodoById<span class=\"token punctuation\">,</span>\n      finishTodoById<span class=\"token punctuation\">,</span>\n      todos\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewlist<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoView</span></span>\n            <span class=\"token attr-name\">todo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">finishTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>finishTodoById<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">removeTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>removeTodoById<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span>\n          <span class=\"token punctuation\">/></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TodoViewList</code></pre></div>\n<p>这里相比 Redux 复杂的“容器组件”概念来说，简单很多，只要在需要 MobX 状态的组件中使用 <code>@observer</code> 装饰器就可以了。简单明了。</p>\n<h2 id=\"7-react-hooks-app-with-redux\"><a href=\"#7-react-hooks-app-with-redux\" aria-label=\"7 react hooks app with redux permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. React Hooks App with Redux</h2>\n<p>React 16.8 的发布带来了全新的 Hooks API，给 React 生态圈带来很多新思路。这里我们看看如何结合 Hooks + Redux 编写一样的应用，和类模式 + Redux 相比有何优势。</p>\n<p>应用结构：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">├── README.md\n├── package.json\n├── public\n│   ├── favicon.ico\n│   ├── index.html\n│   └── manifest.json\n├── src // 源码\n│   ├── App.css\n│   ├── App.test.tsx\n│   ├── App.tsx\n│   ├── components\n│   │   ├── TodoAdd.tsx\n│   │   ├── TodoCounter.tsx\n│   │   ├── TodoView.tsx\n│   │   ├── TodoViewList.tsx\n│   │   ├── assets\n│   │   │   ├── delete.svg\n│   │   │   ├── select.svg\n│   │   │   └── select2.svg\n│   │   └── styles\n│   │       ├── TodoAdd.css\n│   │       ├── TodoCounter.css\n│   │       ├── TodoView.css\n│   │       └── TodoViewList.css\n│   ├── index.css\n│   ├── index.tsx\n│   ├── interfaces\n│   │   ├── base.ts\n│   │   └── index.ts\n│   ├── react-app-env.d.ts\n│   ├── serviceWorker.ts\n│   └── store // redux store\n│       ├── store.tsx\n│       └── todo\n│           ├── actions.ts\n│           ├── index.ts\n│           ├── reducers.ts\n│           └── types.ts\n├── tsconfig.json\n└── yarn.lock</code></pre></div>\n<p>我们发现一个很大的区别，和 Classic React App with Redux 相比这里没有了 container 文件夹了！也就是说我们不需要使用 container 接入 Redux 了。</p>\n<p>是的，原因在于这里我们使用的是 Context API + Hooks API。</p>\n<p>Context API 来替代原有的 <code>react-redux</code> 包中 <code>Provider</code> 组件来全局注入数据。<code>Provider</code> 组件本质上也是用的 React Context API，只是以前不怎么受官方推崇，React 16 出来后，Context API 才正式被认可，使用方式上也变得更简单了。而另一方面， Hooks 中直接内置了对 Redux 的支持，这样就不用安装额外的 Redux 包了。</p>\n<p>事实上，这个应用只用到了 React 自身的特性，没有安装任何外部依赖库：</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@types/jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"24.0.15\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"12.6.8\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/react\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16.8.23\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/react-dom\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16.8.5\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^16.8.6\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react-dom\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^16.8.6\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react-scripts\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.0.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"typescript\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.5.3\"</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Hooks 出现的意义在于可以共享业务逻辑，所以这个应用中最核心的文件在于 store 文件夹下的 <code>store.tsx</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  TodoReducerType<span class=\"token punctuation\">,</span>\n  TodoActionType<span class=\"token punctuation\">,</span>\n\n  initalTodoState<span class=\"token punctuation\">,</span>\n  todoReducer\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./todo'</span>\n\n<span class=\"token keyword\">type</span> combineDispatchsType <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>Dispatch<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoActionType</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\n// 将所有的 dispatch 组合\nconst combineDispatchs = (dispatchs: Array</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>combineDispatchsType</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">) => (obj: TodoActionType) => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  i <span class=\"token operator\">&lt;</span> dispatchs<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    dispatchs<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\n// 根组件状态\nconst AppState = </span><span class=\"token punctuation\">{</span>\n  todoState<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> TodoReducerType<span class=\"token punctuation\">,</span>\n  dispatch<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> ReturnType<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>typeof</span> <span class=\"token attr-name\">combineDispatchs</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n}\n\n// Context\nexport const ContextStore = React.createContext(AppState)\n\nconst HookContextProvider: React.FC = ({ children }) => </span><span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todoState<span class=\"token punctuation\">,</span> todoDispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>\n    todoReducer<span class=\"token punctuation\">,</span>\n    initalTodoState\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ContextStore.Provider</span></span>\n      <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n        todoState<span class=\"token punctuation\">,</span>\n        dispatch<span class=\"token punctuation\">:</span> <span class=\"token function\">combineDispatchs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n          todoDispatch\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n    <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ContextStore.Provider</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\nexport default HookContextProvider</span></code></pre></div>\n<p>这个文件干了这些事：</p>\n<blockquote>\n<ol>\n<li>定义包含 state 和 action 的 AppState</li>\n<li>使用 AppState 初始化 React.createContext，生成全局的 ContextStore</li>\n<li>使用 React.useReducer 生成具体的 todoState、todoDispatch</li>\n<li>通过 ContextStore.Provider 组件将 todoState、todoDispatch 注入整个应用</li>\n</ol>\n</blockquote>\n<p>可以看到,<code>todoState</code>、<code>todoDispatch</code> 才是整个代码的重点，因为这里包含着整个应用的 state 和 action，而生成 state 和 action 的 <code>React.useReducer</code> 中的参数：<code>todoReducer</code>、<code>initalTodoState</code>，就是正常的 Redux 模式中的 <code>Reducer</code> 函数，事实上，这里的 todo 文件夹就是原封不动将类模式那个 todo 文件夹搬过来的。核心概念都是一样的。</p>\n<p>这也说明了，React 通过 Hooks API 将 Redux 概念整个地吸收进来了。</p>\n<p>而在组件中，我们使用也很方便：</p>\n<p><strong>TodoViewList.tsx:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  useContext\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token keyword\">import</span> TodoView <span class=\"token keyword\">from</span> <span class=\"token string\">'./TodoView'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  ContextStore\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store/store'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">SELECT_TODO</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">REMOVE_TODO</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store/todo'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles/TodoViewList.css'</span>\n\n<span class=\"token keyword\">const</span> TodoViewList<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    todoState<span class=\"token punctuation\">,</span>\n    dispatch\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>ContextStore<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 发起 action 操作</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">selectTodoById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">SELECT_TODO</span><span class=\"token punctuation\">,</span>\n    id\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">removeTodoById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">REMOVE_TODO</span><span class=\"token punctuation\">,</span>\n    id\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewlist<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>todoState<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoView</span></span>\n          <span class=\"token attr-name\">todo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">selectTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>selectTodoById<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">removeTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>removeTodoById<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TodoViewList</code></pre></div>\n<p>只需要使用 <code>const { todoState, dispatch } = useContext(ContextStore)</code>，非常方便。</p>\n<h2 id=\"8-react-hooks-app-with-mobx\"><a href=\"#8-react-hooks-app-with-mobx\" aria-label=\"8 react hooks app with mobx permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. React Hooks App with Mobx</h2>\n<p>相比起 Hooks 吸收了 Redux，MobX 并没有直接被 Hooks 化，还是需要外部的依赖。</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@types/jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"24.0.15\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"12.6.8\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/react\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16.8.23\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@types/react-dom\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16.8.5\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"mobx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^5.13.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"mobx-react-lite\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.4.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^16.8.6\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react-dom\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^16.8.6\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"react-scripts\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.0.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"typescript\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.5.3\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>值得一提的是，<code>mobx-react-lite</code> 这个包是 <code>mobx-react</code> 的精简，是为了跟进 Hooks 而发布的，也就是只能在 React 16.8+ 中使用，不兼容类模式。根据官方说法，lite 包最终还是会合并进 <code>mobx-react</code> 中的。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">├── README.md\n├── package.json\n├── public\n│   ├── favicon.ico\n│   ├── index.html\n│   └── manifest.json\n├── src // 源码\n│   ├── App.css\n│   ├── App.test.tsx\n│   ├── App.tsx\n│   ├── components // UI 组件\n│   │   ├── TodoAdd.tsx\n│   │   ├── TodoCounter.tsx\n│   │   ├── TodoView.tsx\n│   │   ├── TodoViewList.tsx\n│   │   ├── assets\n│   │   │   ├── delete.svg\n│   │   │   ├── select.svg\n│   │   │   └── select2.svg\n│   │   └── styles\n│   │       ├── TodoAdd.css\n│   │       ├── TodoCounter.css\n│   │       ├── TodoView.css\n│   │       └── TodoViewList.css\n│   ├── index.css\n│   ├── index.tsx\n│   ├── interfaces\n│   │   ├── base.ts\n│   │   └── index.ts\n│   ├── react-app-env.d.ts\n│   ├── serviceWorker.ts\n│   └── store // mobx store\n│       ├── index.ts\n│       └── useTodoStore.tsx\n├── tsconfig.json\n└── yarn.lock</code></pre></div>\n<p>这里直接说重点，整个应用的重点在 store 文件夹下的 <code>useTodoStore.tsx</code>：</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  useContext\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  useLocalStore\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react-lite'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  observable\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  ITodo\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../interfaces'</span>\n\n<span class=\"token comment\">// 定义 store shape</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createStore</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  todos<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> ITodo<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 或者 Array&lt;ITodo></span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">finishedTodoCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>finished<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">totalCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">finishTodoById</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        todo<span class=\"token punctuation\">.</span>finished <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>todo<span class=\"token punctuation\">.</span>finished\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">addNewTodo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// *新增 observable Todo 对象</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">observable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      id<span class=\"token punctuation\">:</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> name<span class=\"token punctuation\">,</span>\n      finished<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">removeTodoById</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 找到某一项的位置</span>\n    <span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span> <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">type</span> TTodoStore <span class=\"token operator\">=</span> ReturnType<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>typeof</span> <span class=\"token attr-name\">createStore</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\n\n// 创建 context\nconst TodoStoreContext = React.createContext&lt;TTodoStore | null>(null)\n\n// 创建 Provider，通过 React.Context 来注入\nconst TodoStoreProvider: React.FC = ({ children }) => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">useLocalStore</span><span class=\"token punctuation\">(</span>createStore<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoStoreContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">TodoStoreContext.Provider</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\n// 创建 Hook\nconst useTodoStore = () => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>TodoStoreContext<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>store<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You have forgot to use StoreProvider, shame on you.'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> store\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\nexport </span><span class=\"token punctuation\">{</span>\n  TodoStoreProvider<span class=\"token punctuation\">,</span>\n  useTodoStore\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>这里，<code>TodoStoreProvider</code> 组件是 Context 的封装，使用 <code>useLocalStore</code> 生成 MobX store，而 <code>useTodoStore</code> Hook 是对于 <code>useContext</code> 的封装，所以，在组件中使用也就变得很方便：</p>\n<p><strong>App.tsx:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./App.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> TodoAdd <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoAdd'</span>\n<span class=\"token keyword\">import</span> TodoViewList <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoViewList'</span>\n<span class=\"token keyword\">import</span> TodoCounter <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/TodoCounter'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  TodoStoreProvider\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./store'</span>\n\n<span class=\"token keyword\">const</span> App<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoStoreProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">React Hooks App ( mobx )</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoAdd</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoViewList</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoCounter</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">TodoStoreProvider</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>TodoViewList.tsx:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  observer\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react-lite'</span>\n\n<span class=\"token keyword\">import</span> TodoView <span class=\"token keyword\">from</span> <span class=\"token string\">'./TodoView'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles/TodoViewList.css'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  useTodoStore\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store'</span>\n\n<span class=\"token keyword\">const</span> TodoViewList<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span> <span class=\"token operator\">=</span> <span class=\"token function\">observer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> todoStore <span class=\"token operator\">=</span> <span class=\"token function\">useTodoStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewlist<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>todoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoView</span></span>\n          <span class=\"token attr-name\">todo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">finishTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoStore<span class=\"token punctuation\">.</span>finishTodoById<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">removeTodoById</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todoStore<span class=\"token punctuation\">.</span>removeTodoById<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TodoViewList</code></pre></div>\n<p>个人觉得，比起 React Hooks App with Redux 这个例子，使用方式要复杂一点，但比类模式要简约不少，定义的 <code>useTodoStore</code> 可以在任何组件中使用，如果后续要拓展的话，完全可以照着再写一个 <code>useXXXStore</code>。</p>\n<h2 id=\"9-总结\"><a href=\"#9-%E6%80%BB%E7%BB%93\" aria-label=\"9 总结 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. 总结</h2>\n<p>四个 example 写下来，我的个人感受：</p>\n<ol>\n<li>Hooks 确实比类模式简化很多，是 React 技术栈的未来趋势</li>\n<li>MobX 也不一定比 Redux 简约，比如 Hooks 下 MobX 接入也稍显麻烦，不像 Redux 那样直接内化为官方 API</li>\n<li>Redux 的 reducer 和 action 的功能可以由类模式无痛迁移到 Hooks 中</li>\n<li>Typescript 是真的 power！中央决定了，以后就由你当我的主力语言了！</li>\n</ol>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367\">Dan Abramov - You Might Not Need Redux</a></li>\n<li><a href=\"https://cn.mobx.js.org/\">MobX 中文官网</a></li>\n<li><a href=\"https://mobx-react.js.org\">MobX with React</a></li>\n<li><a href=\"https://dev.to/ryands17/using-mobx-with-react-hooks-52h5\">Using MobX with React Hooks</a></li>\n<li><a href=\"https://medium.com/@Whien/%E9%80%8F%E9%81%8E-react-usecontext-%E8%88%87-usereducer-%E4%BE%86%E5%81%9A-global-state-manager-bed30fb1f08b\">透過 React CreateContext 搭配 React useContext 與 useReducer 來做 Global State Manager</a></li>\n</ul>","fields":{"slug":"/content/React-React 状态管理使用指南/"},"frontmatter":{"title":"React 状态管理使用指南","category":"React","tags":"React_Usage","date":"2019-08-11"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/content/React-React 状态管理使用指南/"}}}